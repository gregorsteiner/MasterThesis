---
title: "Extreme Heat Events and Fatal Car Accidents"
author: "Gregor Steiner"
date: "`r format(Sys.Date(), format = '%m/%d/%Y')`"
output:
  md_document:
    variant: markdown_github
bibliography: references.bib  
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      warning = FALSE,
                      message = FALSE,
                      fig.pos = "center",
                      fig.width = 8,
                      fig.height = 6)
```




```{r}
# preliminaries
library(data.table)

```

## Extreme Heat Events and Fatal Car Accidents

In my master thesis I want to explore the causal effect of extreme heat events on fatal car accidents.

### Weather Data

Using data provided by the Daily Global Historical Climatology Network [@Menne_2012], I identify extreme heat events in the historical temperature time series. Historical weather data is available for about 1200 measurement stations in the US. Based on the latitude and longitude coordinates I assign each station to the county it belongs to. In case there is more than one station per county, I take the mean among those.

Following the National Climate Data Center (NCDC), I define an extreme heat event as days in which the maximum or minimum temperature exceed the 85th percentile of July and August maximum or minimum temperatures [@Habeeb_2015]. Below you can see the historical daily maximum temperatures for a few selected counties with such extreme heat events shaded in red.


```{r}
# read data
data <- readRDS("DataCombined.RDS")


# Define counties of interest
counties <- c("JACKSON COUNTY, OREGON", "ONTARIO COUNTY, NEW YORK",
             "ORANGE COUNTY, CALIFORNIA", "YORK COUNTY, SOUTH CAROLINA",
             "PIMA COUNTY, ARIZONA", "CHAMPAIGN COUNTY, ILLINOIS")


# Make plots
par(mfrow = c(round(length(counties) / 2), 2),
    mar = c(2, 4, 2, 1))
invisible(lapply(counties, function(x){
  # Select County
  dat <- data[data$StateCounty == x, ]
  
  # Get dates with extreme heat
  heatdates <- unlist(dat[dat$EHE.MAX == 1, "DATE"])
  
  # make graph
  plot(dat$DATE, dat$TMAX, type = "n",
       ylab = "Temperature in Â°C", xlab = "", main = x)
  
  abline(v = heatdates, col = rgb(1, 0, 0, 0.3), lwd = 1)
  lines(dat$DATE, dat$TMAX, lwd = 1)
  
}))



```


### Car Crash Data




## References



